remotes::install_github("https://github.com/ccolonescu/PoEdata")
library(PoEdata)
data("edu_inc", package="PoEdata")
mod1 <- lm(faminc~he+we, data=edu_inc)
mod2 <- lm(faminc~he, data=edu_inc)
kable(tidy(mod1), caption="The correct model")%>%
kable_styling(full_width = T)
data("edu_inc", package="PoEdata")
mod1 <- lm(faminc~he+we, data=edu_inc)
mod2 <- lm(faminc~he, data=edu_inc)
kable(tidy(mod1), caption="The correct model")%>%
kable_styling(full_width = T)
library(dplyr)
data("edu_inc", package="PoEdata")
mod1 <- lm(faminc~he+we, data=edu_inc)
mod2 <- lm(faminc~he, data=edu_inc)
kable(tidy(mod1), caption="The correct model")%>%
kable_styling(full_width = T)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
install.packages("readxl")
library(readxl)
data = read_excel("ColGPA_HW2.xls")
data
model = lm(formula = colGPA ~ hsGPA + ACT + pc + skipped, data = data)
summary(model)
data = read_excel("ColGPA_HW2.xls")
library(lmtest)
install.packages("lmtest")
library(lmtest)
?bptest
bptest(model)
data = read.csv("BirthWt.csv")
data
model = lm(formula = LogBW ~ CigPerDay + Order + Male, data = data)
data
model = lm(formula = LogBW ~ Mother_CigPerDay + Order + Male, data = data)
summary(model)
model = lm(formula = MotherEducation ~ Mother_CigPerDay + Order + Male, data = data)
summary(model)
summary(model)
par(mfrow=c(1,1))
data("food",package="PoEdata")
mod1 <- lm(food_exp~income, data=food)
res <- residuals(mod1)
yhat <- fitted(mod1)
par(mfrow=c(1,2))
plot(food$income,res, xlab="income", ylab="residuals")
plot(yhat,res, xlab="fitted values", ylab="residuals")
par(mfrow=c(1,1))
library(readxl)
library(lmtest)
data = read_excel("ColGPA_HW2.xls")
mod1 = lm(formula = colGPA ~ hsGPA + ACT + pc + skipped, data = data)
summary(mod1)
bptest(mod1,~fitted(mod1)+I(fitted(mod1)^2))
e <- residuals(mod1)
e
mod2 = lm(formula = e^2 ~ pred + pred_2)
error <- residuals(mod1)
square_error <- error^2
pred_colGPA <- fitted(mod1)
square_pred_colGPA <- pred_colGPA^2
mod2 = lm(formula = square_error ~ pred_colGPA + square_pred_colGPA)
square_error_pred <- fitted(mod1)^2
error <- residuals(mod1)
square_error <- error^2
pred_colGPA <- fitted(mod1)
square_pred_colGPA <- pred_colGPA^2
mod2 = lm(formula = square_error ~ pred_colGPA + square_pred_colGPA)
square_error_pred <- fitted(mod1)^2
w <- 1/square_error_pred
wls <- lm(formula = colGPA ~ hsGPA + ACT + pc + skipped, data = data)
summary(wls)
error <- residuals(mod1)
square_error <- error^2
pred_colGPA <- fitted(mod1)
square_pred_colGPA <- pred_colGPA^2
mod2 = lm(formula = square_error ~ pred_colGPA + square_pred_colGPA)
square_error_pred <- fitted(mod1)^2
w <- 1/square_error_pred
wls <- lm(formula = colGPA ~ hsGPA + ACT + pc + skipped, weights=w, data = data)
summary(wls)
hccm
install.packages("car")
cov1 <- hccm(mod1, type="hc1") #needs package 'car'
library(lmtest)
library(readxl)
library(lmtest)
library(readxl)
library(lmtest)
library(car)
cov1 <- hccm(mod1, type="hc1") #needs package 'car'
coeftest
vcvfoodeq <- coeftest(mod1, vcov.=cov1)
vcvfoodeq
kable
install.packages('knitr')
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
install.packages("broom")
library(readxl)
library(lmtest)
library(car)
library(broom)
library(knitr)
cov1 <- hccm(mod1, type="hc1") #needs package 'car'
vcvfoodeq <- coeftest(mod1, vcov.=cov1)
kable(tidy(mod1),
caption="OLS estimates for the 'food' equation")%>%
kable_styling(full_width = T)
library(readxl)
library(lmtest)
library(car)
library(broom)
library(knitr)
library(dplyr)
cov1 <- hccm(mod1, type="hc1") #needs package 'car'
vcvfoodeq <- coeftest(mod1, vcov.=cov1)
kable(tidy(mod1),
caption="OLS estimates for the 'food' equation")%>%
kable_styling(full_width = T)
install.packages('kableExtra')
library(readxl)
library(lmtest)
library(car)
library(broom)
library(knitr)
library(dplyr)
library(kableExtra)
cov1 <- hccm(mod1, type="hc1") #needs package 'car'
vcvfoodeq <- coeftest(mod1, vcov.=cov1)
kable(tidy(mod1),
caption="OLS estimates for the 'food' equation")%>%
kable_styling(full_width = T)
kable(tidy(wls),
caption="WLS estimates for the 'food' equation" )%>%
kable_styling(full_width = T)
kable(tidy(vcvfoodeq),caption=
"OLS estimates for the 'food' equation with robust standard errors" )%>%
kable_styling(full_width = T)
cov1 <- hccm(mod1, type="hc1") #needs package 'car'
vcvfoodeq <- coeftest(mod1, vcov.=cov1)
kable(tidy(mod1),
caption="OLS estimates for the 'food' equation")%>%
kable_styling(full_width = T)
kable(tidy(wls),
caption="WLS estimates for the 'food' equation" )%>%
kable_styling(full_width = T)
kable(tidy(vcvfoodeq),caption=
"OLS estimates for the 'food' equation with robust standard errors" )%>%
kable_styling(full_width = T)
cov1 <- hccm(mod1, type="hc1") #needs package 'car'
vcvfoodeq <- coeftest(mod1, vcov.=cov1)
kable(tidy(mod1),
caption="OLS estimates for the equation")%>%
kable_styling(full_width = T)
kable(tidy(wls),
caption="WLS estimates for the equation" )%>%
kable_styling(full_width = T)
kable(tidy(vcvfoodeq),caption=
"OLS estimates for the equation with robust standard errors" )%>%
kable_styling(full_width = T)
cov1 <- hccm(mod1, type="hc1") #needs package 'car'
vcvfoodeq <- coeftest(mod1, vcov.=cov1)
kable(tidy(wls),
caption="WLS estimates for the equation" )%>%
kable_styling(full_width = T)
kable(tidy(vcvfoodeq),caption=
"OLS estimates for the equation with robust standard errors" )%>%
kable_styling(full_width = T)
data("mroz", package="PoEdata")
mroz1 <- mroz[mroz$lfp==1,] #restricts sample to lfp=1.
mroz1.ols <- lm(log(wage)~educ+exper+I(exper^2), data=mroz1)
mroz1.iv <- ivreg(log(wage)~educ+exper+I(exper^2)|
exper+I(exper^2)+mothereduc, data=mroz1)
install.packages('ivreg')
library(readxl)
library(lmtest)
library(car)
library(broom)
library(knitr)
library(dplyr)
library(kableExtra)
library(ivreg)
data("mroz", package="PoEdata")
mroz1 <- mroz[mroz$lfp==1,] #restricts sample to lfp=1.
mroz1.ols <- lm(log(wage)~educ+exper+I(exper^2), data=mroz1)
mroz1.iv <- ivreg(log(wage)~educ+exper+I(exper^2)|
exper+I(exper^2)+mothereduc, data=mroz1)
mroz1.iv1 <- ivreg(log(wage)~educ+exper+I(exper^2)|
exper+I(exper^2)+mothereduc+fathereduc,
data=mroz1)
stargazer(mroz1.ols, wage.2sls, mroz1.iv, mroz1.iv1,
title="Wage equation: OLS, 2SLS, and IV models compared",
header=FALSE,
type='text', # "html" or "latex" (in index.Rmd)
keep.stat="n",  # what statistics to print
omit.table.layout="n",
star.cutoffs=NA,
digits=4,
#  single.row=TRUE,
intercept.bottom=FALSE, #moves the intercept coef to top
column.labels=c("OLS","By-Hand 2SLS", "IV-mothereduc",
"IV-mother&fathereduc"),
dep.var.labels.include = FALSE,
model.numbers = FALSE,
dep.var.caption="Dependent variable: wage",
model.names=FALSE,
star.char=NULL) #supresses the stars)
install.packages('stargazer')
data("mroz", package="PoEdata")
mroz1 <- mroz[mroz$lfp==1,] #restricts sample to lfp=1.
mroz1.ols <- lm(log(wage)~educ+exper+I(exper^2), data=mroz1)
mroz1.iv <- ivreg(log(wage)~educ+exper+I(exper^2)|
exper+I(exper^2)+mothereduc, data=mroz1)
mroz1.iv1 <- ivreg(log(wage)~educ+exper+I(exper^2)|
exper+I(exper^2)+mothereduc+fathereduc,
data=mroz1)
stargazer(mroz1.ols, wage.2sls, mroz1.iv, mroz1.iv1,
title="Wage equation: OLS, 2SLS, and IV models compared",
header=FALSE,
type='text', # "html" or "latex" (in index.Rmd)
keep.stat="n",  # what statistics to print
omit.table.layout="n",
star.cutoffs=NA,
digits=4,
#  single.row=TRUE,
intercept.bottom=FALSE, #moves the intercept coef to top
column.labels=c("OLS","By-Hand 2SLS", "IV-mothereduc",
"IV-mother&fathereduc"),
dep.var.labels.include = FALSE,
model.numbers = FALSE,
dep.var.caption="Dependent variable: wage",
model.names=FALSE,
star.char=NULL) #supresses the stars)
library(stargazer)
data("mroz", package="PoEdata")
mroz1 <- mroz[mroz$lfp==1,] #restricts sample to lfp=1.
mroz1.ols <- lm(log(wage)~educ+exper+I(exper^2), data=mroz1)
mroz1.iv <- ivreg(log(wage)~educ+exper+I(exper^2)|
exper+I(exper^2)+mothereduc, data=mroz1)
mroz1.iv1 <- ivreg(log(wage)~educ+exper+I(exper^2)|
exper+I(exper^2)+mothereduc+fathereduc,
data=mroz1)
stargazer(mroz1.ols, wage.2sls, mroz1.iv, mroz1.iv1,
title="Wage equation: OLS, 2SLS, and IV models compared",
header=FALSE,
type='text', # "html" or "latex" (in index.Rmd)
keep.stat="n",  # what statistics to print
omit.table.layout="n",
star.cutoffs=NA,
digits=4,
#  single.row=TRUE,
intercept.bottom=FALSE, #moves the intercept coef to top
column.labels=c("OLS","By-Hand 2SLS", "IV-mothereduc",
"IV-mother&fathereduc"),
dep.var.labels.include = FALSE,
model.numbers = FALSE,
dep.var.caption="Dependent variable: wage",
model.names=FALSE,
star.char=NULL) #supresses the stars)
data("mroz", package="PoEdata")
mroz1 <- mroz[mroz$lfp==1,] #restricts sample to lfp=1
educ.ols <- lm(educ~exper+I(exper^2)+mothereduc, data=mroz1)
kable(tidy(educ.ols), digits=4, align='c',caption=
"First stage in the 2SLS model for the 'wage' equation")%>%
kable_styling(full_width = T)
educHat <- fitted(educ.ols)
wage.2sls <- lm(log(wage)~educHat+exper+I(exper^2), data=mroz1)
kable(tidy(wage.2sls), digits=4, align='c',caption=
"Second stage in the 2SLS model for the 'wage' equation (BY-HAND 2SLS)")%>%
kable_styling(full_width = T)%>%
column_spec(1:5, bold = TRUE, border_left = TRUE,border_right  = TRUE, color =  "blue",background = "lightgrey")
data("mroz", package="PoEdata")
mroz1 <- mroz[mroz$lfp==1,] #restricts sample to lfp=1.
mroz1.ols <- lm(log(wage)~educ+exper+I(exper^2), data=mroz1)
mroz1.iv <- ivreg(log(wage)~educ+exper+I(exper^2)|
exper+I(exper^2)+mothereduc, data=mroz1)
mroz1.iv1 <- ivreg(log(wage)~educ+exper+I(exper^2)|
exper+I(exper^2)+mothereduc+fathereduc,
data=mroz1)
stargazer(mroz1.ols, wage.2sls, mroz1.iv, mroz1.iv1,
title="Wage equation: OLS, 2SLS, and IV models compared",
header=FALSE,
type='text', # "html" or "latex" (in index.Rmd)
keep.stat="n",  # what statistics to print
omit.table.layout="n",
star.cutoffs=NA,
digits=4,
#  single.row=TRUE,
intercept.bottom=FALSE, #moves the intercept coef to top
column.labels=c("OLS","By-Hand 2SLS", "IV-mothereduc",
"IV-mother&fathereduc"),
dep.var.labels.include = FALSE,
model.numbers = FALSE,
dep.var.caption="Dependent variable: wage",
model.names=FALSE,
star.char=NULL) #supresses the stars)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
data = read.csv("BirthWt.csv")
model = lm(formula = LogBW ~ Mother_CigPerDay + Order + Male, data = data)
summary(model)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
summary(iv)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
summary(iv)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
summary(iv)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
summary(iv)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
summary(iv)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
summary(iv)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
summary(iv)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
summary(iv)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
summary(iv)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
summary(iv)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
summary(iv)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
summary(iv)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+Mother_CigPerDay, data=data)
summary(iv)
iv <- ivreg(LogBW~Mother_CigPerDay+Order+Male|
Order+Male+MotherEducation, data=data)
summary(iv)
data("transport", package="PoEdata")
auto.probit <- glm(auto~dtime, family=binomial(link="probit"),
data=transport)
kable(tidy(auto.probit), digits=4, align='c', caption=
"Transport example Odds-Ratios, estimated by probit [We ignore these Odds-Ratio results and use the Marginal Effects instead]")%>%
kable_styling(full_width = T)
#Marginal Effect @ X=dtime=2 (i.e.starting from time difference of 20 minutes)
##Marginal Effects Using Package mfx
library(mfx)
#PEA
a <- probitmfx(auto~dtime, data=transport, atmean=TRUE)
paste("That is, when time difference increase by 1 unit (or by 10 mins) from its average value, the rise in probability of taking the auto is:",round(a$mfxest[[1]],4), ".")
#APE
b <- probitmfx(auto~dtime, data=transport, atmean=FALSE)
paste("The Average Marginal Effect  of dtime on probability of choosing to drive rather than take the bus is,",round(b$mfxest[[1]],4),".")
data("coke", package="PoEdata")
coke.logit <- glm(coke~pratio+disp_coke+disp_pepsi,
data=coke, family=binomial(link="logit"))
kable(tidy(coke.logit), digits=5, align="c",
caption="Logit estimates for the 'coke' dataset")%>%
kable_styling(full_width = T)
coke.probit <- glm(coke~pratio+disp_coke+disp_pepsi,
data=coke, family=binomial(link="probit"))
#At the Mean X (PEA:Partial Effect at the Average)
logitmfx(coke~pratio+disp_coke+disp_pepsi,
data=coke, atmean=TRUE)
probitmfx(coke~pratio+disp_coke+disp_pepsi,
data=coke, atmean=TRUE)
#Mean Partial Effect for all X(APE: Average Partial Effect)
logitmfx(coke~pratio+disp_coke+disp_pepsi,
data=coke, atmean=FALSE)
probitmfx(coke~pratio+disp_coke+disp_pepsi,
data=coke, atmean=FALSE)
tble <- data.frame(table(true=coke$coke,
predicted=round(fitted(coke.logit))))
kable(tble, align='c', caption="Logit Confusion Matrix")
tble <- data.frame(table(true=coke$coke,
predicted=round(fitted(coke.probit))))
kable(tble, align='c', caption="Probit Confusion Matrix")
Hnull <- "disp_coke+ disp_pepsi=0"
linearHypothesis(coke.logit, Hnull)
Hnull <- c("disp_coke=0", "disp_pepsi=0")
linearHypothesis(coke.logit, Hnull)
# Log likelihood value:
logLik(coke.logit)
logLik(coke.probit)
# McFadden's pseudo R2:
1 - coke.logit$deviance/coke.logit$null.deviance
1 - coke.probit$deviance/coke.probit$null.deviance
# F-Tests (Overall Model and Partial F-Tests)
# OVERALL MODEL With p-values,...:
lrtest(coke.logit)
lrtest(coke.probit)
data = read_excel('OrganicDecision.xlsx')
data
data$OHW = data$`Online Health Wellness e-Newsletters Subscriber`
data
data$Y = data$`Organic Food Purchaser`
data = read_excel('OrganicDecision.xlsx')
data$Y = data$`Organic Food Purchaser`
data$OHW = data$`Online Health Wellness e-Newsletters Subscriber`
logit <- glm(Y~Age+OHW,
data=data, family=binomial(link="logit"))
kable(tidy(logit), digits=5, align="c",
caption="Logit estimates")%>%
kable_styling(full_width = T)
library(readxl)
library(lmtest)
library(car)
library(broom)
library(knitr)
library(dplyr)
library(kableExtra)
library(ivreg)
library(stargazer)
library(mfx)
a <- logitmfx(Y~Age+OHW, data=data, atmean=TRUE)
a$mfxest
a$mfxest[[1]]
a
structure(a)
b
summary(a)
a
a$mfxest
data = read_excel('OrganicDecision.xlsx')
data$Y = data$`Organic Food Purchaser`
data$OHW = data$`Online Health Wellness e-Newsletters Subscriber`
logit <- glm(Y~Age+OHW,
data=data, family=binomial(link="logit"))
kable(tidy(logit), digits=5, align="c",
caption="Logit estimates")%>%
kable_styling(full_width = T)
a <- logitmfx(Y~Age+OHW, data=data, atmean=TRUE)
print(a)
#APE
b <- logitmfx(Y~Age+OHW, data=data, atmean=FALSE)
print(b)
data = read_excel('OrganicDecision.xlsx')
data$Y = data$`Organic Food Purchaser`
data$OHW = data$`Online Health Wellness e-Newsletters Subscriber`
logit <- glm(Y~Age+OHW,
data=data, family=binomial(link="logit"))
kable(tidy(logit), digits=5, align="c",
caption="Logit estimates")%>%
kable_styling(full_width = T)
a <- logitmfx(Y~Age+OHW, data=data, atmean=TRUE)
print(a)
#APE
b <- logitmfx(Y~Age+OHW, data=data, atmean=FALSE)
print(b)
tble <- data.frame(table(true=data$Y,
predicted=round(fitted(logit))))
kable(tble, align='c', caption="Logit Confusion Matrix")
data("olympics", package="PoEdata")
olympics.count <- glm(medaltot~log(pop)+log(gdp),
family= "poisson",
na.action=na.omit,
data=olympics)
kable(tidy(olympics.count), digits=4, align='c',
caption="Poisson model for the 'olympics' problem")
library(AER)
dispersiontest(olympics.count)
data("olympics", package="PoEdata")
# Estimate linear model
lm.res <-  lm(medaltot~log(pop)+log(gdp), data=olympics)
# Estimate Poisson model
Poisson.res <- glm(medaltot~log(pop)+log(gdp), data=olympics, family=poisson)
# Quasi-Poisson model
QPoisson.res<- glm(medaltot~log(pop)+log(gdp), data=olympics, family=quasipoisson)
# Table
stargazer(lm.res,Poisson.res,QPoisson.res,type="text",keep.stat="n",  intercept.bottom=FALSE)
data = read_excel('Awards.xlsx')
data <- read_excel('Awards.xlsx')
data
data <- read_excel('Awards.xlsx')
data$Business = data$prog == 'Business'
data$Arts = data$prog == 'Arts'
data
data <- read_excel('Awards.xlsx')
data$Business = as.integer(data$prog == 'Business')
data$Arts = as.integer(data$prog == 'Arts')
data
?bptest
data <- read_excel('Awards.xlsx')
data$Business = as.integer(data$prog == 'Business')
data$Arts = as.integer(data$prog == 'Arts')
mod1 <- lm(formula = num_awards ~ Business + Arts + math, data = data)
bptest(mod1,~fitted(mod1)+I(fitted(mod1)^2))
mod2 <- glm(num_awards~Business + Arts + math, data=data, family=poisson)
stargazer(mod2,mod3,type="text",keep.stat="n",  intercept.bottom=FALSE)
mod3 <- glm(num_awards~Business + Arts + math, data=data,  family=quasipoisson)
mod3 <- glm(num_awards~Business + Arts + math, data=data,  family=quasipoisson)
stargazer(mod2,mod3,type="text",keep.stat="n",  intercept.bottom=FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(plm)
library(broom)
mydata <- read_excel("/Users/weizhenliu/Downloads/Bees_Panel.xls")
head(mydata)
mydata$time = ifelse(mydata$Treated == 'Treated',1,0)
mydata$treated = ifelse(mydata$Treated == 'Treated',1,0)
mydata$time
mydata$treated
